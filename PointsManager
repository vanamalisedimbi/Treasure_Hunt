local PointsManager = {}

local Players = game:GetService("Players")
local Teams = game:GetService("Teams")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Create a RemoteEvent for game finish
local GameFinishedEvent = ReplicatedStorage:FindFirstChild("GameFinished")
if not GameFinishedEvent then
	GameFinishedEvent = Instance.new("RemoteEvent")
	GameFinishedEvent.Name = "GameFinished"
	GameFinishedEvent.Parent = ReplicatedStorage
end

-- Initialize leaderstats for each player
local function setupPlayerLeaderstats(player)
	local leaderstats = player:FindFirstChild("leaderstats")
	if not leaderstats then
		leaderstats = Instance.new("Folder")
		leaderstats.Name = "leaderstats"
		leaderstats.Parent = player
		print("âœ… Created leaderstats for", player.Name)
	end

	-- Create Score
	local scoreValue = leaderstats:FindFirstChild("Score")
	if not scoreValue then
		scoreValue = Instance.new("IntValue")
		scoreValue.Name = "Score"
		scoreValue.Parent = leaderstats
		print("âœ… Created Score for", player.Name, "Value:", scoreValue.Value)
	end
end

-- When a new player joins, initialize their leaderboard
Players.PlayerAdded:Connect(setupPlayerLeaderstats)

-- âœ… **Add points function**
function PointsManager.AddPoints(player, points)
	if player and player:IsA("Player") then
		local leaderstats = player:FindFirstChild("leaderstats")
		if leaderstats then
			local scoreValue = leaderstats:FindFirstChild("Score")
			if scoreValue then
				scoreValue.Value = scoreValue.Value + points
				print("ðŸ”„ Updated", player.Name, "Score:", scoreValue.Value)
			end
		end
	end
end

return PointsManager
